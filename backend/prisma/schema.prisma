generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Usuario {
  id               Int           @id @default(autoincrement())
  nome             String
  email            String        @unique
  senha            String
  medula_ossea     Boolean
  tipo_sanguineo   String        @db.VarChar(3)
  data_nascimento  DateTime      @db.Date
  notificacoes     Boolean       @default(true)
  sexo             String        @db.VarChar(1)
  data_criacao     DateTime      @default(now())
  data_modificacao DateTime      @updatedAt
  agendamentos     Agendamento[]
}

model Hemocentros {
  id               Int           @id @default(autoincrement())
  rua              String        @db.VarChar(255)
  bairro           String        @db.VarChar(100)
  cidade           String        @db.VarChar(100)
  numero           String        @db.VarChar(10)
  cep              String        @db.VarChar(10)
  estado           String        @db.VarChar(2)
  data_criacao     DateTime      @default(now())
  data_modificacao DateTime      @updatedAt
  agendamentos     Agendamento[]
}

model Agendamento {
  id                  Int         @id @default(autoincrement())
  usuario_fk          Int
  data_agendamento    DateTime    @db.Date
  horario_agendamento DateTime    @db.Time(6)
  hemocentro_fk       Int
  status_agendamento  String      @default("Pendente") @db.VarChar(20)
  data_criacao        DateTime    @default(now())
  data_modificacao    DateTime    @updatedAt
  hemocentro          Hemocentros @relation(fields: [hemocentro_fk], references: [id], onDelete: Cascade)
  usuario             Usuario     @relation(fields: [usuario_fk], references: [id], onDelete: Cascade)
  doacao              Doacao?
}

model Doacao {
  id                Int         @id @default(autoincrement())
  quantidade_sangue Decimal     @db.Decimal(5, 2)
  agendamento_fk    Int         @unique
  data_criacao      DateTime    @default(now())
  data_modificacao  DateTime    @updatedAt
  agendamento       Agendamento @relation(fields: [agendamento_fk], references: [id], onDelete: Cascade)
}
